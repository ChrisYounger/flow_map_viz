{"version":3,"file":"accessibility.js","sources":["../src/accessibleTarget.js","../src/AccessibilityManager.js","../src/index.js"],"sourcesContent":["/**\n * Default property values of accessible objects\n * used by {@link PIXI.accessibility.AccessibilityManager}.\n *\n * @private\n * @function accessibleTarget\n * @memberof PIXI.accessibility\n * @type {Object}\n * @example\n *      function MyObject() {}\n *\n *      Object.assign(\n *          MyObject.prototype,\n *          PIXI.accessibility.accessibleTarget\n *      );\n */\nexport const accessibleTarget = {\n    /**\n     *  Flag for if the object is accessible. If true AccessibilityManager will overlay a\n     *   shadow div with attributes set\n     *\n     * @member {boolean}\n     * @memberof PIXI.DisplayObject#\n     */\n    accessible: false,\n\n    /**\n     * Sets the title attribute of the shadow div\n     * If accessibleTitle AND accessibleHint has not been this will default to 'displayObject [tabIndex]'\n     *\n     * @member {?string}\n     * @memberof PIXI.DisplayObject#\n     */\n    accessibleTitle: null,\n\n    /**\n     * Sets the aria-label attribute of the shadow div\n     *\n     * @member {string}\n     * @memberof PIXI.DisplayObject#\n     */\n    accessibleHint: null,\n\n    /**\n     * @member {number}\n     * @memberof PIXI.DisplayObject#\n     * @private\n     * @todo Needs docs.\n     */\n    tabIndex: 0,\n\n    /**\n     * @member {boolean}\n     * @memberof PIXI.DisplayObject#\n     * @todo Needs docs.\n     */\n    _accessibleActive: false,\n\n    /**\n     * @member {boolean}\n     * @memberof PIXI.DisplayObject#\n     * @todo Needs docs.\n     */\n    _accessibleDiv: false,\n\n    /**\n     * Specify the type of div the accessible layer is. Screen readers treat the element differently\n     * depending on this type. Defaults to button.\n     *\n     * @member {string}\n     * @memberof PIXI.DisplayObject#\n     * @default 'button'\n     */\n    accessibleType: 'button',\n\n    /**\n     * Specify the pointer-events the accessible div will use\n     * Defaults to auto.\n     *\n     * @member {string}\n     * @memberof PIXI.DisplayObject#\n     * @default 'auto'\n     */\n    accessiblePointerEvents: 'auto',\n\n    /**\n     * Setting to false will prevent any children inside this container to\n     * be accessible. Defaults to true.\n     *\n     * @member {boolean}\n     * @memberof PIXI.DisplayObject#\n     * @default true\n     */\n    accessibleChildren: true,\n};\n","import { accessibleTarget } from './accessibleTarget';\nimport { removeItems, isMobile } from '@pixi/utils';\nimport { DisplayObject } from '@pixi/display';\n\n// add some extra variables to the container..\nDisplayObject.mixin(accessibleTarget);\n\nconst KEY_CODE_TAB = 9;\n\nconst DIV_TOUCH_SIZE = 100;\nconst DIV_TOUCH_POS_X = 0;\nconst DIV_TOUCH_POS_Y = 0;\nconst DIV_TOUCH_ZINDEX = 2;\n\nconst DIV_HOOK_SIZE = 1;\nconst DIV_HOOK_POS_X = -1000;\nconst DIV_HOOK_POS_Y = -1000;\nconst DIV_HOOK_ZINDEX = 2;\n\n/**\n * The Accessibility manager recreates the ability to tab and have content read by screen readers.\n * This is very important as it can possibly help people with disabilities access PixiJS content.\n *\n * A DisplayObject can be made accessible just like it can be made interactive. This manager will map the\n * events as if the mouse was being used, minimizing the effort required to implement.\n *\n * An instance of this class is automatically created by default, and can be found at `renderer.plugins.accessibility`\n *\n * @class\n * @memberof PIXI.accessibility\n */\nexport class AccessibilityManager\n{\n    /**\n     * @param {PIXI.CanvasRenderer|PIXI.Renderer} renderer - A reference to the current renderer\n     */\n    constructor(renderer)\n    {\n        /**\n         * @type {?HTMLElement}\n         * @private\n         */\n        this._hookDiv = null;\n        if (isMobile.tablet || isMobile.phone)\n        {\n            this.createTouchHook();\n        }\n\n        // first we create a div that will sit over the PixiJS element. This is where the div overlays will go.\n        const div = document.createElement('div');\n\n        div.style.width = `${DIV_TOUCH_SIZE}px`;\n        div.style.height = `${DIV_TOUCH_SIZE}px`;\n        div.style.position = 'absolute';\n        div.style.top = `${DIV_TOUCH_POS_X}px`;\n        div.style.left = `${DIV_TOUCH_POS_Y}px`;\n        div.style.zIndex = DIV_TOUCH_ZINDEX;\n\n        /**\n         * This is the dom element that will sit over the PixiJS element. This is where the div overlays will go.\n         *\n         * @type {HTMLElement}\n         * @private\n         */\n        this.div = div;\n\n        /**\n         * A simple pool for storing divs.\n         *\n         * @type {*}\n         * @private\n         */\n        this.pool = [];\n\n        /**\n         * This is a tick used to check if an object is no longer being rendered.\n         *\n         * @type {Number}\n         * @private\n         */\n        this.renderId = 0;\n\n        /**\n         * Setting this to true will visually show the divs.\n         *\n         * @type {boolean}\n         */\n        this.debug = false;\n\n        /**\n         * The renderer this accessibility manager works for.\n         *\n         * @member {PIXI.AbstractRenderer}\n         */\n        this.renderer = renderer;\n\n        /**\n         * The array of currently active accessible items.\n         *\n         * @member {Array<*>}\n         * @private\n         */\n        this.children = [];\n\n        /**\n         * pre-bind the functions\n         *\n         * @type {Function}\n         * @private\n         */\n        this._onKeyDown = this._onKeyDown.bind(this);\n\n        /**\n         * pre-bind the functions\n         *\n         * @type {Function}\n         * @private\n         */\n        this._onMouseMove = this._onMouseMove.bind(this);\n\n        /**\n         * A flag\n         * @type {boolean}\n         * @readonly\n         */\n        this.isActive = false;\n\n        /**\n         * A flag\n         * @type {boolean}\n         * @readonly\n         */\n        this.isMobileAccessibility = false;\n\n        // let listen for tab.. once pressed we can fire up and show the accessibility layer\n        window.addEventListener('keydown', this._onKeyDown, false);\n    }\n\n    /**\n     * Creates the touch hooks.\n     *\n     * @private\n     */\n    createTouchHook()\n    {\n        const hookDiv = document.createElement('button');\n\n        hookDiv.style.width = `${DIV_HOOK_SIZE}px`;\n        hookDiv.style.height = `${DIV_HOOK_SIZE}px`;\n        hookDiv.style.position = 'absolute';\n        hookDiv.style.top = `${DIV_HOOK_POS_X}px`;\n        hookDiv.style.left = `${DIV_HOOK_POS_Y}px`;\n        hookDiv.style.zIndex = DIV_HOOK_ZINDEX;\n        hookDiv.style.backgroundColor = '#FF0000';\n        hookDiv.title = 'HOOK DIV';\n\n        hookDiv.addEventListener('focus', () =>\n        {\n            this.isMobileAccessibility = true;\n            this.activate();\n            this.destroyTouchHook();\n        });\n\n        document.body.appendChild(hookDiv);\n        this._hookDiv = hookDiv;\n    }\n\n    /**\n     * Destroys the touch hooks.\n     *\n     * @private\n     */\n    destroyTouchHook()\n    {\n        if (!this._hookDiv)\n        {\n            return;\n        }\n        document.body.removeChild(this._hookDiv);\n        this._hookDiv = null;\n    }\n\n    /**\n     * Activating will cause the Accessibility layer to be shown.\n     * This is called when a user presses the tab key.\n     *\n     * @private\n     */\n    activate()\n    {\n        if (this.isActive)\n        {\n            return;\n        }\n\n        this.isActive = true;\n\n        window.document.addEventListener('mousemove', this._onMouseMove, true);\n        window.removeEventListener('keydown', this._onKeyDown, false);\n\n        this.renderer.on('postrender', this.update, this);\n\n        if (this.renderer.view.parentNode)\n        {\n            this.renderer.view.parentNode.appendChild(this.div);\n        }\n    }\n\n    /**\n     * Deactivating will cause the Accessibility layer to be hidden.\n     * This is called when a user moves the mouse.\n     *\n     * @private\n     */\n    deactivate()\n    {\n        if (!this.isActive || this.isMobileAccessibility)\n        {\n            return;\n        }\n\n        this.isActive = false;\n\n        window.document.removeEventListener('mousemove', this._onMouseMove, true);\n        window.addEventListener('keydown', this._onKeyDown, false);\n\n        this.renderer.off('postrender', this.update);\n\n        if (this.div.parentNode)\n        {\n            this.div.parentNode.removeChild(this.div);\n        }\n    }\n\n    /**\n     * This recursive function will run through the scene graph and add any new accessible objects to the DOM layer.\n     *\n     * @private\n     * @param {PIXI.Container} displayObject - The DisplayObject to check.\n     */\n    updateAccessibleObjects(displayObject)\n    {\n        if (!displayObject.visible || !displayObject.accessibleChildren)\n        {\n            return;\n        }\n\n        if (displayObject.accessible && displayObject.interactive)\n        {\n            if (!displayObject._accessibleActive)\n            {\n                this.addChild(displayObject);\n            }\n\n            displayObject.renderId = this.renderId;\n        }\n\n        const children = displayObject.children;\n\n        for (let i = 0; i < children.length; i++)\n        {\n            this.updateAccessibleObjects(children[i]);\n        }\n    }\n\n    /**\n     * Before each render this function will ensure that all divs are mapped correctly to their DisplayObjects.\n     *\n     * @private\n     */\n    update()\n    {\n        if (!this.renderer.renderingToScreen)\n        {\n            return;\n        }\n\n        // update children...\n        this.updateAccessibleObjects(this.renderer._lastObjectRendered);\n\n        const rect = this.renderer.view.getBoundingClientRect();\n        const sx = rect.width / this.renderer.width;\n        const sy = rect.height / this.renderer.height;\n\n        let div = this.div;\n\n        div.style.left = `${rect.left}px`;\n        div.style.top = `${rect.top}px`;\n        div.style.width = `${this.renderer.width}px`;\n        div.style.height = `${this.renderer.height}px`;\n\n        for (let i = 0; i < this.children.length; i++)\n        {\n            const child = this.children[i];\n\n            if (child.renderId !== this.renderId)\n            {\n                child._accessibleActive = false;\n\n                removeItems(this.children, i, 1);\n                this.div.removeChild(child._accessibleDiv);\n                this.pool.push(child._accessibleDiv);\n                child._accessibleDiv = null;\n\n                i--;\n\n                if (this.children.length === 0)\n                {\n                    this.deactivate();\n                }\n            }\n            else\n            {\n                // map div to display..\n                div = child._accessibleDiv;\n                let hitArea = child.hitArea;\n                const wt = child.worldTransform;\n\n                if (child.hitArea)\n                {\n                    div.style.left = `${(wt.tx + (hitArea.x * wt.a)) * sx}px`;\n                    div.style.top = `${(wt.ty + (hitArea.y * wt.d)) * sy}px`;\n\n                    div.style.width = `${hitArea.width * wt.a * sx}px`;\n                    div.style.height = `${hitArea.height * wt.d * sy}px`;\n                }\n                else\n                {\n                    hitArea = child.getBounds();\n\n                    this.capHitArea(hitArea);\n\n                    div.style.left = `${hitArea.x * sx}px`;\n                    div.style.top = `${hitArea.y * sy}px`;\n\n                    div.style.width = `${hitArea.width * sx}px`;\n                    div.style.height = `${hitArea.height * sy}px`;\n\n                    // update button titles and hints if they exist and they've changed\n                    if (div.title !== child.accessibleTitle && child.accessibleTitle !== null)\n                    {\n                        div.title = child.accessibleTitle;\n                    }\n                    if (div.getAttribute('aria-label') !== child.accessibleHint\n                        && child.accessibleHint !== null)\n                    {\n                        div.setAttribute('aria-label', child.accessibleHint);\n                    }\n                }\n\n                // the title or index may have changed, if so lets update it!\n                if (child.accessibleTitle !== div.title || child.tabIndex !== div.tabIndex)\n                {\n                    div.title = child.accessibleTitle;\n                    div.tabIndex = child.tabIndex;\n                    if (this.debug) this.updateDebugHTML(div);\n                }\n            }\n        }\n\n        // increment the render id..\n        this.renderId++;\n    }\n\n    /**\n     * private function that will visually add the information to the\n     * accessability div\n     *\n     * @param {HTMLDivElement} div\n     */\n    updateDebugHTML(div)\n    {\n        div.innerHTML = `type: ${div.type}</br> title : ${div.title}</br> tabIndex: ${div.tabIndex}`;\n    }\n\n    /**\n     * Adjust the hit area based on the bounds of a display object\n     *\n     * @param {PIXI.Rectangle} hitArea - Bounds of the child\n     */\n    capHitArea(hitArea)\n    {\n        if (hitArea.x < 0)\n        {\n            hitArea.width += hitArea.x;\n            hitArea.x = 0;\n        }\n\n        if (hitArea.y < 0)\n        {\n            hitArea.height += hitArea.y;\n            hitArea.y = 0;\n        }\n\n        if (hitArea.x + hitArea.width > this.renderer.width)\n        {\n            hitArea.width = this.renderer.width - hitArea.x;\n        }\n\n        if (hitArea.y + hitArea.height > this.renderer.height)\n        {\n            hitArea.height = this.renderer.height - hitArea.y;\n        }\n    }\n\n    /**\n     * Adds a DisplayObject to the accessibility manager\n     *\n     * @private\n     * @param {PIXI.DisplayObject} displayObject - The child to make accessible.\n     */\n    addChild(displayObject)\n    {\n        //    this.activate();\n\n        let div = this.pool.pop();\n\n        if (!div)\n        {\n            div = document.createElement('button');\n\n            div.style.width = `${DIV_TOUCH_SIZE}px`;\n            div.style.height = `${DIV_TOUCH_SIZE}px`;\n            div.style.backgroundColor = this.debug ? 'rgba(255,255,255,0.5)' : 'transparent';\n            div.style.position = 'absolute';\n            div.style.zIndex = DIV_TOUCH_ZINDEX;\n            div.style.borderStyle = 'none';\n\n            // ARIA attributes ensure that button title and hint updates are announced properly\n            if (navigator.userAgent.toLowerCase().indexOf('chrome') > -1)\n            {\n                // Chrome doesn't need aria-live to work as intended; in fact it just gets more confused.\n                div.setAttribute('aria-live', 'off');\n            }\n            else\n            {\n                div.setAttribute('aria-live', 'polite');\n            }\n\n            if (navigator.userAgent.match(/rv:.*Gecko\\//))\n            {\n                // FireFox needs this to announce only the new button name\n                div.setAttribute('aria-relevant', 'additions');\n            }\n            else\n            {\n                // required by IE, other browsers don't much care\n                div.setAttribute('aria-relevant', 'text');\n            }\n\n            div.addEventListener('click', this._onClick.bind(this));\n            div.addEventListener('focus', this._onFocus.bind(this));\n            div.addEventListener('focusout', this._onFocusOut.bind(this));\n        }\n\n        // set pointer events\n        div.style.pointerEvents = displayObject.accessiblePointerEvents;\n        // set the type, this defaults to button!\n        div.type = displayObject.accessibleType;\n\n        if (displayObject.accessibleTitle && displayObject.accessibleTitle !== null)\n        {\n            div.title = displayObject.accessibleTitle;\n        }\n        else if (!displayObject.accessibleHint\n                 || displayObject.accessibleHint === null)\n        {\n            div.title = `displayObject ${displayObject.tabIndex}`;\n        }\n\n        if (displayObject.accessibleHint\n            && displayObject.accessibleHint !== null)\n        {\n            div.setAttribute('aria-label', displayObject.accessibleHint);\n        }\n\n        if (this.debug) this.updateDebugHTML(div);\n\n        displayObject._accessibleActive = true;\n        displayObject._accessibleDiv = div;\n        div.displayObject = displayObject;\n\n        this.children.push(displayObject);\n        this.div.appendChild(displayObject._accessibleDiv);\n        displayObject._accessibleDiv.tabIndex = displayObject.tabIndex;\n    }\n\n    /**\n     * Maps the div button press to pixi's InteractionManager (click)\n     *\n     * @private\n     * @param {MouseEvent} e - The click event.\n     */\n    _onClick(e)\n    {\n        const interactionManager = this.renderer.plugins.interaction;\n\n        interactionManager.dispatchEvent(e.target.displayObject, 'click', interactionManager.eventData);\n        interactionManager.dispatchEvent(e.target.displayObject, 'pointertap', interactionManager.eventData);\n        interactionManager.dispatchEvent(e.target.displayObject, 'tap', interactionManager.eventData);\n    }\n\n    /**\n     * Maps the div focus events to pixi's InteractionManager (mouseover)\n     *\n     * @private\n     * @param {FocusEvent} e - The focus event.\n     */\n    _onFocus(e)\n    {\n        if (!e.target.getAttribute('aria-live', 'off'))\n        {\n            e.target.setAttribute('aria-live', 'assertive');\n        }\n        const interactionManager = this.renderer.plugins.interaction;\n\n        interactionManager.dispatchEvent(e.target.displayObject, 'mouseover', interactionManager.eventData);\n    }\n\n    /**\n     * Maps the div focus events to pixi's InteractionManager (mouseout)\n     *\n     * @private\n     * @param {FocusEvent} e - The focusout event.\n     */\n    _onFocusOut(e)\n    {\n        if (!e.target.getAttribute('aria-live', 'off'))\n        {\n            e.target.setAttribute('aria-live', 'polite');\n        }\n        const interactionManager = this.renderer.plugins.interaction;\n\n        interactionManager.dispatchEvent(e.target.displayObject, 'mouseout', interactionManager.eventData);\n    }\n\n    /**\n     * Is called when a key is pressed\n     *\n     * @private\n     * @param {KeyboardEvent} e - The keydown event.\n     */\n    _onKeyDown(e)\n    {\n        if (e.keyCode !== KEY_CODE_TAB)\n        {\n            return;\n        }\n\n        this.activate();\n    }\n\n    /**\n     * Is called when the mouse moves across the renderer element\n     *\n     * @private\n     * @param {MouseEvent} e - The mouse event.\n     */\n    _onMouseMove(e)\n    {\n        if (e.movementX === 0 && e.movementY === 0)\n        {\n            return;\n        }\n\n        this.deactivate();\n    }\n\n    /**\n     * Destroys the accessibility manager\n     *\n     */\n    destroy()\n    {\n        this.destroyTouchHook();\n        this.div = null;\n\n        for (let i = 0; i < this.children.length; i++)\n        {\n            this.children[i].div = null;\n        }\n\n        window.document.removeEventListener('mousemove', this._onMouseMove, true);\n        window.removeEventListener('keydown', this._onKeyDown);\n\n        this.pool = null;\n        this.children = null;\n        this.renderer = null;\n    }\n}\n","/**\n * This namespace contains an accessibility plugin for allowing interaction via the keyboard.\n *\n * Do not instantiate this plugin directly. It is available from the `renderer.plugins` property.\n * See {@link PIXI.CanvasRenderer#plugins} or {@link PIXI.Renderer#plugins}.\n * @namespace PIXI.accessibility\n */\nexport * from './accessibleTarget';\nexport * from './AccessibilityManager';\n"],"names":["DisplayObject","const","isMobile","this","let","removeItems"],"mappings":"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"}