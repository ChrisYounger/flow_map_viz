/*!
 * @pixi/spritesheet - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/spritesheet is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
this.PIXI=this.PIXI||{};var _pixi_spritesheet=function(t,e,s,r,i){"use strict";var a=function(t,e,s){void 0===s&&(s=null),this.baseTexture=t,this.textures={},this.animations={},this.data=e,this.resolution=this._updateResolution(s||(this.baseTexture.resource?this.baseTexture.resource.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null},o={BATCH_SIZE:{configurable:!0}};o.BATCH_SIZE.get=function(){return 1e3},a.prototype._updateResolution=function(t){var e=this.data.meta.scale,s=r.getResolutionOfUrl(t,null);return null===s&&(s=void 0!==e?parseFloat(e):1),1!==s&&this.baseTexture.setResolution(s),s},a.prototype.parse=function(t){this._batchIndex=0,this._callback=t,this._frameKeys.length<=a.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},a.prototype._processFrames=function(t){for(var r=t,i=a.BATCH_SIZE;r-t<i&&r<this._frameKeys.length;){var o=this._frameKeys[r],n=this._frames[o],h=n.frame;if(h){var u=null,l=null,c=!1!==n.trimmed&&n.sourceSize?n.sourceSize:n.frame,f=new e.Rectangle(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);u=n.rotated?new e.Rectangle(Math.floor(h.x)/this.resolution,Math.floor(h.y)/this.resolution,Math.floor(h.h)/this.resolution,Math.floor(h.w)/this.resolution):new e.Rectangle(Math.floor(h.x)/this.resolution,Math.floor(h.y)/this.resolution,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution),!1!==n.trimmed&&n.spriteSourceSize&&(l=new e.Rectangle(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution)),this.textures[o]=new s.Texture(this.baseTexture,u,f,l,n.rotated?2:0,n.anchor),s.Texture.addToCache(this.textures[o],o)}r++}},a.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var s=0;s<t[e].length;s++){var r=t[e][s];this.animations[e].push(this.textures[r])}}},a.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},a.prototype._nextBatch=function(){var t=this;this._processFrames(this._batchIndex*a.BATCH_SIZE),this._batchIndex++,setTimeout(function(){t._batchIndex*a.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())},0)},a.prototype.destroy=function(t){for(var e in void 0===t&&(t=!1),this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&this.baseTexture.destroy(),this.baseTexture=null},Object.defineProperties(a,o);var n=function(){};return n.use=function(t,e){var s=t.name+"_image";if(t.data&&t.type===i.LoaderResource.TYPE.JSON&&t.data.frames&&!this.resources[s]){var r={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},o=n.getResourcePath(t,this.baseUrl);this.add(s,o,r,function(s){if(s.error)e(s.error);else{var r=new a(s.texture.baseTexture,t.data,t.url);r.parse(function(){t.spritesheet=r,t.textures=r.textures,e()})}})}else e()},n.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:r.url.resolve(t.url.replace(e,""),t.data.meta.image)},t.Spritesheet=a,t.SpritesheetLoader=n,t}({},PIXI,PIXI,PIXI.utils,PIXI);Object.assign(this.PIXI,_pixi_spritesheet);
//# sourceMappingURL=spritesheet.min.js.map
